<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sign Up</title>
    <script src="https://cdn.jsdelivr.net/npm/fingerprintjs2@2.1.0/dist/fingerprint2.min.js"></script>
</head>
<body>
    <h1>Sign Up for Early Access</h1>
    <form id="signup-form">
        <label for="email">Enter your email:</label>
        <input type="email" id="email" required placeholder="Your Email">
        <button type="submit">Sign Up</button>
    </form>

    <script>
        // Example URL list
        const urls = ["url1", "url2", "url3", "url4"];
        
        // Fingerprint-based URL assignment
        function generateFingerprint(callback) {
            new Fingerprint2().get(function(result) {
                callback(result);  // Pass fingerprint to callback
            });
        }

        // Function to assign URL based on fingerprint
        function assignUrl(fingerprint) {
            // Compute the URL index using a simple hash-based method
            const urlIndex = parseInt(fingerprint.substr(0, 8), 16) % urls.length;
            const assignedUrl = urls[urlIndex];
            
            // Store the fingerprint and assigned URL
            localStorage.setItem("userFingerprint", fingerprint);
            localStorage.setItem("userUrl", assignedUrl);

            console.log("Assigned URL:", assignedUrl);  // For debugging purposes

            // Redirect user to form page or dashboard
            window.location.href = "form.html";  // Change to wherever you want the user to go
        }

        // Event listener for form submission
        document.getElementById("signup-form").addEventListener("submit", (event) => {
            event.preventDefault();  // Prevent the form from reloading the page

            const email = document.getElementById("email").value;  // Get the email entered by the user
            if (!email) {
                alert("Please enter a valid email address.");
                return;  // If no email is entered, do nothing
            }

            // Check if the user already has a fingerprint (indicating they've signed up before)
            const existingFingerprint = localStorage.getItem("userFingerprint");

            if (existingFingerprint) {
                // Redirect to the dashboard or wherever you want returning users to go
                window.location.href = "dashboard.html";  // Modify as needed
            } else {
                // New user: generate fingerprint and assign URL
                generateFingerprint(assignUrl);
            }

             // Redirect to form page
    window.location.href = "/share-3/form/";
});
       
    </script>
</body>
</html>
