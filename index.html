<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sign Up</title>
    <script src="https://cdn.jsdelivr.net/npm/fingerprintjs2@2.1.0/dist/fingerprint2.min.js"></script>
</head>
<body>
    <h1>Sign Up for Early Access</h1>
    <form id="signup-form">
        <label for="email">Enter your email:</label>
        <input type="email" id="email" required placeholder="Your Email">
        <button type="submit">Sign Up</button>
    </form>

    <script>
        const urls = ["url1", "url2", "url3", "url4"]; // Example URL list
        let urlIndex = 0; // URL counter

        // Function to generate the fingerprint
        function generateFingerprint(callback) {
            new Fingerprint2().get(function(result) {
                callback(result); // Pass the fingerprint to the callback function
            });
        }

        // Function to assign the URL based on the fingerprint
        function assignUrl(fingerprint) {
            // Get the index from the fingerprint (could be any hash-based function)
            urlIndex = parseInt(fingerprint.substr(0, 8), 16) % urls.length;

            // Get the assigned URL
            const assignedUrl = urls[urlIndex];
            console.log("Assigned URL: ", assignedUrl);

            // Store the fingerprint and assigned URL in localStorage
            localStorage.setItem("userFingerprint", fingerprint);
            localStorage.setItem("userUrl", assignedUrl);

            // Redirect user to another page (form.html in this example)
            window.location.href = "/share-3/form/"; // Redirect to form or wherever
        }

        // Event listener for the signup form submission
        document.getElementById("signup-form").addEventListener("submit", (event) => {
            event.preventDefault();  // Prevent form from reloading the page

            const email = document.getElementById("email").value;  // Get the email input value

            if (!email) {
                alert("Please enter a valid email address.");
                return;  // Stop if no email is entered
            }

            // Check if the user already has a fingerprint and assigned URL
            const existingFingerprint = localStorage.getItem("userFingerprint");
            if (existingFingerprint) {
                // Redirect returning user (they already have a URL)
                window.location.href = "dashboard.html"; // Example: Redirect to dashboard page
            } else {
                // New user, generate fingerprint and assign URL
                generateFingerprint(assignUrl);  // Generate fingerprint and assign URL
            }
        });
    </script>
</body>
</html>
